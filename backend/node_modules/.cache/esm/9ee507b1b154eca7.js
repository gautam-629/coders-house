let jwt,accessTokenSecret,refreshTokenSecret,RefreshModel;_b15‍.x([["default",()=>_b15‍.o]]);_b15‍.w("jsonwebtoken",[["default",["jwt"],function(v){jwt=v}]]);_b15‍.w("../Config",[["accessTokenSecret",["accessTokenSecret"],function(v){accessTokenSecret=v}],["refreshTokenSecret",["refreshTokenSecret"],function(v){refreshTokenSecret=v}]]);_b15‍.w("../models/RefreshModel",[["default",["RefreshModel"],function(v){RefreshModel=v}]]);


class TokenServices{
    static generateAccessToken(payload){
        return jwt.sign(payload,accessTokenSecret,{ expiresIn:'1m'});
      }
        
        static generateRefressToken(payload){
        return  jwt.sign(payload,refreshTokenSecret,{ expiresIn:'1h'})
       }

       static async storeRefreshToken(token,userId){
            try {
                await RefreshModel.create({
                  token,
                  userId
                })  
            } catch (error) {
              _b15‍.g.console.log(error)
            }
       }

       static async verifyAccessToken(token){
             return jwt.verify(token,accessTokenSecret);
       }
     static  async verifyRefreshToken(refreshToken) {
        return jwt.verify(refreshToken, refreshTokenSecret);
    }
  static  async findRefreshToken(userId, refreshToken) {
      return await RefreshModel.findOne({
          userId: userId,
          token: refreshToken,
      });
  }

 static async updateRefreshToken(userId, refreshToken) {
    return await RefreshModel.updateOne(
        { userId: userId },
        { token: refreshToken }
    );
}

static async removeToken(refreshToken) {
  return await RefreshModel.deleteOne({ token: refreshToken });
}
}

_b15‍.d(TokenServices);